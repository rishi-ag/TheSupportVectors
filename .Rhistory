nvars<-sum(cumvar<0.99)
sum(cumvar<0.95)
# Get only the 99% variance variables from PCA variables
features<-features[,1:nvars]
vectors<-vectors[,1:nvars]
nvars
confusion
install.packages(xtable)
install.packages("xtable")
library(xtable)
heatmap(confusion[,-8])
xtable(confusion)
print(xtable(confusion))
write.csv(confusion,"data/rfor_confusion.csv")
table<-read.csv("data/rfor_confusion.csv")
cat(apply(talbe, 1, function(X) paste(X, collapse=" , ")), sep = "\n")
cat(apply(table, 1, function(X) paste(X, collapse=" , ")), sep = "\n")
setwd("D:/master/kaggle/TheSupportVectors")
table<-read.csv("data/rfor_confusion.csv")
table
cat(apply(table, 1, function(X) paste(X, collapse=" | ")), sep = "\n")
cat(apply(table, 1, function(X) paste(X, collapse="   ")), sep = "\n")
install.packages("sjPlot")
library(sjPlot)
sjt.df(confusion)
confusion
confusion<-as.data.frame(confusion)
sjt.df(confusion)
source("code/library.R")
train.data <- get.train.data()
labels <- as.factor(train.data[[1]])
features <- train.data[[3]]
class(features)
class(labels)
sjt.df(features)
features <- train.data[[2]]
sjt.df(features)
sjt.df(features, alternateRowColors=TRUE)
table<-as.data.frame(table)
sjt.df(table, alternateRowColors=TRUE,describe=FALSE)
names(table)<-c(1:7,"Classif.Error")
table[,8]<-round(table[,8],3)
sjt.df(table, alternateRowColors=TRUE,describe=FALSE)
table<-read.csv("data/rfor_confusion.csv")
table<-as.data.frame(table)
sjt.df(table, alternateRowColors=TRUE,describe=FALSE)
table<-as.data.frame(table)
table<-table[,-1]
names(table)<-c(1:7,"Classif.Error")
table[,8]<-round(table[,8],3)
sjt.df(table, alternateRowColors=TRUE,describe=FALSE)
class(features.std)
features.std<-train.data[[3]]
class(features.std)
str(features.std)
id <- read.csv(file = "data/Kaggle_Covertype_test_id.csv", header = T)[,1]
head(id)
class(id)
tail(id)
length(id)
id <- seq(50001,100000,1)
head(id)
tail(id)
id <- seq(50001,150000,1)
tail(id)
length(id)
model<-readRDS("rforest_model2.rds")
model<-readRDS("data/rforest_model2.rds")
model$err.rate
plot(model$err.rate[,1])
qplot(model$err.rate[,1])
plot(model$err.rate[,1],type="l")
plot(model$err.rate[,1],type="l",xlab="Number of trees",ylab="OOB error rate")
plot(model$err.rate[,1],type="l",xlab="Number of trees",ylab="OOB error rate",main="Error rate, ntree param, random forest")
plot(model$err.rate[,1],type="l",xlab="Number of trees",ylab="OOB error rate",main="Error rate, ntree param (random forest)")
plot(model$err.rate[,1],type="l",xlab="Number of trees",ylab="OOB error rate",main="Error rate (random forest)")
data<-data.frame(features,labels)
str(data)
str(features)
table(labels,features[,11:54])
xtabs(labels~features[,11:54])
xtabs(labels~as.afeatures[,11:54])
xtabs(labels~as.matrix(features[,11:54]))
dim(labels)
length(labels)
length(features[,11])
xtabs(labels~as.matrix(features[,11:54])
)
xtabs(labels~features[,11])
if(!require("dplyr"))install.packages("dplyr")
if(!require("tidyr"))install.packages("tidyr")
source("code/library.R")
#get data
train <- get.train.data()
labels <- train.data[[1]]
features <- train.data[[2]]
features.std <- train.data[[3]]
# Data per category
train<-tbl_df(train)
#means and st.dev of explanatory variables per category
means<-aggregate(train[,2:55],by=list(train$Cover_Type),FUN="mean")
sd<-aggregate(train[,2:55],by=list(train$Cover_Type),FUN="mean")
# Soil types vs cat
soil_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
sc1=sum(soil_type_1),
sc2=sum(soil_type_2),
sc3=sum(soil_type_3),
sc4=sum(soil_type_4),
sc5=sum(soil_type_5),
sc6=sum(soil_type_6),
sc7=sum(soil_type_7),
sc8=sum(soil_type_8),
sc9=sum(soil_type_9),
sc10=sum(soil_type_10),
sc11=sum(soil_type_11),
sc12=sum(soil_type_12),
sc13=sum(soil_type_13),
sc14=sum(soil_type_14),
sc15=sum(soil_type_15),
sc16=sum(soil_type_16),
sc17=sum(soil_type_17),
sc18=sum(soil_type_18),
sc19=sum(soil_type_19),
sc20=sum(soil_type_20),
sc21=sum(soil_type_21),
sc22=sum(soil_type_22),
sc23=sum(soil_type_23),
sc24=sum(soil_type_24),
sc25=sum(soil_type_25),
sc26=sum(soil_type_26),
sc27=sum(soil_type_27),
sc28=sum(soil_type_28),
sc29=sum(soil_type_29),
sc30=sum(soil_type_30),
sc31=sum(soil_type_31),
sc32=sum(soil_type_32),
sc33=sum(soil_type_33),
sc34=sum(soil_type_34),
sc35=sum(soil_type_35),
sc36=sum(soil_type_36),
sc37=sum(soil_type_37),
sc38=sum(soil_type_38),
sc39=sum(soil_type_39),
sc40=sum(soil_type_40)
)
soil_cat
train<-tbl_df(features)
soil_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
sc1=sum(soil_type_1),
sc2=sum(soil_type_2),
sc3=sum(soil_type_3),
sc4=sum(soil_type_4),
sc5=sum(soil_type_5),
sc6=sum(soil_type_6),
sc7=sum(soil_type_7),
sc8=sum(soil_type_8),
sc9=sum(soil_type_9),
sc10=sum(soil_type_10),
sc11=sum(soil_type_11),
sc12=sum(soil_type_12),
sc13=sum(soil_type_13),
sc14=sum(soil_type_14),
sc15=sum(soil_type_15),
sc16=sum(soil_type_16),
sc17=sum(soil_type_17),
sc18=sum(soil_type_18),
sc19=sum(soil_type_19),
sc20=sum(soil_type_20),
sc21=sum(soil_type_21),
sc22=sum(soil_type_22),
sc23=sum(soil_type_23),
sc24=sum(soil_type_24),
sc25=sum(soil_type_25),
sc26=sum(soil_type_26),
sc27=sum(soil_type_27),
sc28=sum(soil_type_28),
sc29=sum(soil_type_29),
sc30=sum(soil_type_30),
sc31=sum(soil_type_31),
sc32=sum(soil_type_32),
sc33=sum(soil_type_33),
sc34=sum(soil_type_34),
sc35=sum(soil_type_35),
sc36=sum(soil_type_36),
sc37=sum(soil_type_37),
sc38=sum(soil_type_38),
sc39=sum(soil_type_39),
sc40=sum(soil_type_40)
)
soil_cat
class(features)
train<-data.frame(features,Cover_Type=as.factor(labels))
train<-tbl_df(features)
# Soil types vs cat
soil_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
sc1=sum(soil_type_1),
sc2=sum(soil_type_2),
sc3=sum(soil_type_3),
sc4=sum(soil_type_4),
sc5=sum(soil_type_5),
sc6=sum(soil_type_6),
sc7=sum(soil_type_7),
sc8=sum(soil_type_8),
sc9=sum(soil_type_9),
sc10=sum(soil_type_10),
sc11=sum(soil_type_11),
sc12=sum(soil_type_12),
sc13=sum(soil_type_13),
sc14=sum(soil_type_14),
sc15=sum(soil_type_15),
sc16=sum(soil_type_16),
sc17=sum(soil_type_17),
sc18=sum(soil_type_18),
sc19=sum(soil_type_19),
sc20=sum(soil_type_20),
sc21=sum(soil_type_21),
sc22=sum(soil_type_22),
sc23=sum(soil_type_23),
sc24=sum(soil_type_24),
sc25=sum(soil_type_25),
sc26=sum(soil_type_26),
sc27=sum(soil_type_27),
sc28=sum(soil_type_28),
sc29=sum(soil_type_29),
sc30=sum(soil_type_30),
sc31=sum(soil_type_31),
sc32=sum(soil_type_32),
sc33=sum(soil_type_33),
sc34=sum(soil_type_34),
sc35=sum(soil_type_35),
sc36=sum(soil_type_36),
sc37=sum(soil_type_37),
sc38=sum(soil_type_38),
sc39=sum(soil_type_39),
sc40=sum(soil_type_40)
)
soil_cat
str(train)
train<-data.frame(features,Cover_Type=as.factor(labels))
train<-tbl_df(train)
soil_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
sc1=sum(soil_type_1),
sc2=sum(soil_type_2),
sc3=sum(soil_type_3),
sc4=sum(soil_type_4),
sc5=sum(soil_type_5),
sc6=sum(soil_type_6),
sc7=sum(soil_type_7),
sc8=sum(soil_type_8),
sc9=sum(soil_type_9),
sc10=sum(soil_type_10),
sc11=sum(soil_type_11),
sc12=sum(soil_type_12),
sc13=sum(soil_type_13),
sc14=sum(soil_type_14),
sc15=sum(soil_type_15),
sc16=sum(soil_type_16),
sc17=sum(soil_type_17),
sc18=sum(soil_type_18),
sc19=sum(soil_type_19),
sc20=sum(soil_type_20),
sc21=sum(soil_type_21),
sc22=sum(soil_type_22),
sc23=sum(soil_type_23),
sc24=sum(soil_type_24),
sc25=sum(soil_type_25),
sc26=sum(soil_type_26),
sc27=sum(soil_type_27),
sc28=sum(soil_type_28),
sc29=sum(soil_type_29),
sc30=sum(soil_type_30),
sc31=sum(soil_type_31),
sc32=sum(soil_type_32),
sc33=sum(soil_type_33),
sc34=sum(soil_type_34),
sc35=sum(soil_type_35),
sc36=sum(soil_type_36),
sc37=sum(soil_type_37),
sc38=sum(soil_type_38),
sc39=sum(soil_type_39),
sc40=sum(soil_type_40)
)
soil_cat
View(soil_cat)
View(t(soil_cat))
# total obs per category
cat<- train %>%
group_by(Cover_Type) %>%
summarise(
nobs=n()
)
cat
# soil type in percent inside category
soil_pct_cat<-merge (soil_cat,cat)
soil_pct_cat[,-1]<-round(soil_pct_cat[,-1]/soil_pct_cat[,c("nobs")],5)
soil_pct_cat<-subset(soil_pct_cat,select=-nobs)
soil_pct_Cat
soil_pct_cat
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$Cover_Type,main=names(train)[i])
}
#save plot
jpeg(filename = 'plots/soil_explore.jpg', units = "in", width = 5, height = 5, res = 400)
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$Cover_Type,main=names(train)[i])
}
dev.off()
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$area,main=names(train)[i])
}
#save plot
jpeg(filename = 'plots/area_explore.jpg', units = "in", width = 5, height = 5, res = 400)
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$area,main=names(train)[i])
}
dev.off()
train <- get.train.data()
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$area,main=names(train)[i])
}
#save plot
jpeg(filename = 'plots/area_explore.jpg', units = "in", width = 5, height = 5, res = 400)
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$area,main=names(train)[i])
}
dev.off()
train<-data.frame(features,Cover_Type=as.factor(labels))
# Correlation between variables
pairs(train[,c(2:11,57)],pch=19,alpha=0.2)
cor<-cor(train[,c(2:11)])
plot3<-heatmap(cor)
#save plot
jpeg(filename = 'plots/heatmap_explore.jpg', units = "in", width = 5, height = 5, res = 400)
plot3
dev.off()
# Categories vs areas
cat_area<- train %>%
select(area,Cover_Type,id)%>%
group_by(area,Cover_Type) %>%
summarise(
nobs=n()
)
cat_area <- spread(
cat_area, # table to make wider
area, # key defining columns
nobs # values to fill columns
)
par(mfrow=c(1,1))
plot(nobs~ Cover_Type,data=cat_area,type="p")
points(cat_area$Cover_Type,data=cat_area,type="p")
cat_area
cat_area
cat_area<- train %>%
select(area,Cover_Type,id)%>%
group_by(area,Cover_Type) %>%
summarise(
nobs=n()
)
str(train)
train<-data.frame(features,Cover_Type=as.factor(labels))
# Data per category
train<-tbl_df(train)
# Data per wild area
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$area,main=names(train)[i])
}
#save plot
jpeg(filename = 'plots/area_explore.jpg', units = "in", width = 5, height = 5, res = 400)
par(mfrow=c(2,5))
for (i in (2:11)){
boxplot(train[[i]]~train$area,main=names(train)[i])
}
dev.off()
str(train)
cor<-cor(train[,c(1:10)])
plot3<-heatmap(cor)
plot3
cor<-cor(features[,c(1:10)])
plot3<-heatmap(cor)
plot3
jpeg(filename = 'plots/heatmap_explore.jpg', units = "in", width = 5, height = 5, res = 400)
plot3
dev.off()
str(features)
train <- get.train.data()
labels <- train.data[[1]]
features <- train.data[[2]]
cor<-cor(features[,c(1:10)])
plot3<-heatmap(cor)
plot3
cor
heatmap(cor)
jpeg(filename = 'plots/heatmap_explore.jpg', units = "in", width = 5, height = 5, res = 400)
plot3
dev.off()
jpeg(filename = 'plots/heatmap_explore.jpg', units = "in", width = 5, height = 5, res = 400)
heatmap(cor)
dev.off()
jpeg(filename = 'plots/heatmap_explore.jpg', units = "in", width = 3, height = 3, res = 300)
heatmap(cor)
dev.off()
jpeg(filename = 'plots/heatmap.jpg', units = "in", width = 2, height = 2, res = 100)
heatmap(cor)
dev.off()
jpeg(filename = 'plots/heatmap.jpg', units = "in", width = 3, height = 3, res = 200)
heatmap(cor)
dev.off()
area_cat
area_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
area1=sum(wild_area_1),
area2=sum(wild_area_2),
area3=sum(wild_area_3),
area4=sum(wild_area_4)
)
area_cat<-as.data.frame(t(area_cat))
if (!require("knitr")) install.packages("knitr")
if (!require("rmarkdown")) install.packages("rmarkdown")
if (!require("sjPlot")) install.packages("sjPlot")
opts_chunk$set(fig.width=8, fig.height=5, warning=FALSE, message=FALSE,
include=TRUE, echo=TRUE, cache=TRUE, cache.comments=FALSE)
if(!require("reshape2"))install.packages("reshape2")
if(!require("ggplot2"))install.packages("ggplot2")
if(!require("ggthemes"))install.packages("ggthemes")
if(!require("dplyr"))install.packages("dplyr")
if(!require("tidyr"))install.packages("tidyr")
source("code/library.R")
train <- get.train.data()
train.label <- train[[1]]
labels_df <- as.data.frame(train.label)
train.feat <- train[[3]]
source("code/library.R")
train.data <- get.train.data()
labels <- as.factor(train.data[[1]])
features <- train.data[[2]]
features.std<-train.data[[3]]
train<-data.frame(features,Cover_Type=as.factor(labels))
# Data per category
train<-tbl_df(train)
# Soil types vs cat
soil_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
sc1=sum(soil_type_1),
sc2=sum(soil_type_2),
sc3=sum(soil_type_3),
sc4=sum(soil_type_4),
sc5=sum(soil_type_5),
sc6=sum(soil_type_6),
sc7=sum(soil_type_7),
sc8=sum(soil_type_8),
sc9=sum(soil_type_9),
sc10=sum(soil_type_10),
sc11=sum(soil_type_11),
sc12=sum(soil_type_12),
sc13=sum(soil_type_13),
sc14=sum(soil_type_14),
sc15=sum(soil_type_15),
sc16=sum(soil_type_16),
sc17=sum(soil_type_17),
sc18=sum(soil_type_18),
sc19=sum(soil_type_19),
sc20=sum(soil_type_20),
sc21=sum(soil_type_21),
sc22=sum(soil_type_22),
sc23=sum(soil_type_23),
sc24=sum(soil_type_24),
sc25=sum(soil_type_25),
sc26=sum(soil_type_26),
sc27=sum(soil_type_27),
sc28=sum(soil_type_28),
sc29=sum(soil_type_29),
sc30=sum(soil_type_30),
sc31=sum(soil_type_31),
sc32=sum(soil_type_32),
sc33=sum(soil_type_33),
sc34=sum(soil_type_34),
sc35=sum(soil_type_35),
sc36=sum(soil_type_36),
sc37=sum(soil_type_37),
sc38=sum(soil_type_38),
sc39=sum(soil_type_39),
sc40=sum(soil_type_40)
)
soil_cat<-as.data.frame(t(soil_cat))
# Soil types vs cat
area_cat<- train %>%
group_by(Cover_Type) %>%
summarise(
area1=sum(wild_area_1),
area2=sum(wild_area_2),
area3=sum(wild_area_3),
area4=sum(wild_area_4)
)
area_cat<-as.data.frame(t(area_cat))
area_cat
